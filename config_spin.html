<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản Lý Quay Số Ngẫu Nhiên</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            background-image: url('https://www.transparenttextures.com/patterns/digital-circuit.png');
            background-size: cover;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .nav-tabs .nav-link {
            color: #333;
        }
        .nav-tabs .nav-link.active {
            background-color: #ff69b4;
            color: white;
        }
        .tab-content {
            background-color: white;
            padding: 20px;
            border-radius: 0 0 10px 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .table th, .table td {
            vertical-align: middle;
            text-align: center;
        }
        .btn-primary {
            background-color: #ff69b4;
            border: none;
        }
        .btn-primary:hover {
            background-color: #ff1493;
        }
        .btn-danger {
            background-color: #dc3545;
        }
        .btn-danger:hover {
            background-color: #c82333;
        }
        .btn-warning {
            background-color: #ffc107;
            color: #333;
        }
        .btn-warning:hover {
            background-color: #e0a800;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .modal-header {
            background-color: #ff69b4;
            color: white;
        }
        .modal-footer .btn-primary {
            background-color: #ff69b4;
        }
        .modal-footer .btn-primary:hover {
            background-color: #ff1493;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-center mb-4">QUẢN LÝ QUAY SỐ NGẪU NHIÊN</h1>
        <a href="spin.html" class="btn btn-primary mb-3">Quay Số Ngẫu Nhiên</a>

        <!-- Tabs -->
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="prizes-tab" data-bs-toggle="tab" data-bs-target="#prizes" type="button" role="tab" aria-controls="prizes" aria-selected="true">Quản lý giải quay</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="participants-tab" data-bs-toggle="tab" data-bs-target="#participants" type="button" role="tab" aria-controls="participants" aria-selected="false">Danh sách người tham dự</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="winners-tab" data-bs-toggle="tab" data-bs-target="#winners" type="button" role="tab" aria-controls="winners" aria-selected="false">Danh sách trúng giải</button>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="myTabContent">
            <!-- Tab Quản lý giải quay -->
            <div class="tab-pane fade show active" id="prizes" role="tabpanel" aria-labelledby="prizes-tab">
                <h3>Quản lý giải quay</h3>
                <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addPrizeModal">Thêm giải</button>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>STT</th>
                            <th>Tên giải</th>
                            <th>Số lần quay</th>
                            <th>Trạng thái</th>
                            <th>Hành động</th>
                        </tr>
                    </thead>
                    <tbody id="prizeTableBody"></tbody>
                </table>
            </div>

            <!-- Tab Danh sách người tham dự -->
            <div class="tab-pane fade" id="participants" role="tabpanel" aria-labelledby="participants-tab">
                <h3>Danh sách người tham dự</h3>
                <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addParticipantModal">Thêm người tham dự</button>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>STT</th>
                            <th>Họ tên</th>
                            <th>Phòng ban</th>
                            <th>Mã quay số</th>
                            <th>Hành động</th>
                        </tr>
                    </thead>
                    <tbody id="participantTableBody"></tbody>
                </table>
            </div>

            <!-- Tab Danh sách trúng giải -->
            <div class="tab-pane fade" id="winners" role="tabpanel" aria-labelledby="winners-tab">
                <h3>Danh sách trúng giải</h3>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>STT</th>
                            <th>Ngày</th>
                            <th>Tên giải</th>
                            <th>Lần</th>
                            <th>Họ tên</th>
                            <th>Phòng ban</th>
                            <th>Mã quay số</th>
                            <th>Hành động</th>
                        </tr>
                    </thead>
                    <tbody id="winnerTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Modal Thêm/Chỉnh sửa Giải -->
    <div class="modal fade" id="addPrizeModal" tabindex="-1" aria-labelledby="addPrizeModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addPrizeModalLabel">Thêm giải</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="prizeForm">
                        <div class="form-group">
                            <label for="prizeName">Tên giải</label>
                            <input type="text" class="form-control" id="prizeName" required>
                        </div>
                        <div class="form-group">
                            <label for="prizeTurns">Số lần quay</label>
                            <input type="number" class="form-control" id="prizeTurns" min="1" required>
                        </div>
                        <input type="hidden" id="prizeIndex">
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                    <button type="button" class="btn btn-primary" onclick="savePrize()">Lưu</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Thêm/Chỉnh sửa Người tham dự -->
    <div class="modal fade" id="addParticipantModal" tabindex="-1" aria-labelledby="addParticipantModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addParticipantModalLabel">Thêm người tham dự</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="participantForm">
                        <div class="form-group">
                            <label for="participantName">Họ tên</label>
                            <input type="text" class="form-control" id="participantName" required>
                        </div>
                        <div class="form-group">
                            <label for="participantDepartment">Phòng ban</label>
                            <input type="text" class="form-control" id="participantDepartment" required>
                        </div>
                        <div class="form-group">
                            <label for="participantCode">Mã quay số</label>
                            <input type="text" class="form-control" id="participantCode" required>
                        </div>
                        <input type="hidden" id="participantIndex">
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                    <button type="button" class="btn btn-primary" onclick="saveParticipant()">Lưu</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS and Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
    <script>
        // Khởi tạo dữ liệu từ localStorage
        let prizes = JSON.parse(localStorage.getItem('prizes')) || [];
        let participants = JSON.parse(localStorage.getItem('participants')) || [];
        let winners = JSON.parse(localStorage.getItem('winners')) || [];

        // Hiển thị danh sách giải
        function displayPrizes() {
            const tableBody = document.getElementById('prizeTableBody');
            tableBody.innerHTML = '';
            prizes.forEach((prize, index) => {
                const row = `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${prize.name}</td>
                        <td>${prize.turns}</td>
                        <td>${prize.status}</td>
                        <td>
                            <button class="btn btn-warning btn-sm" onclick="editPrize(${index})">Sửa</button>
                            <button class="btn btn-danger btn-sm" onclick="deletePrize(${index})">Xóa</button>
                        </td>
                    </tr>
                `;
                tableBody.innerHTML += row;
            });
        }

        // Thêm hoặc chỉnh sửa giải
        function savePrize() {
            const name = document.getElementById('prizeName').value;
            const turns = parseInt(document.getElementById('prizeTurns').value);
            const index = document.getElementById('prizeIndex').value;

            if (index === '') {
                // Thêm mới
                prizes.push({ name, turns, status: 'Chưa quay' });
            } else {
                // Cập nhật
                prizes[index] = { name, turns, status: prizes[index].status };
            }

            localStorage.setItem('prizes', JSON.stringify(prizes));
            displayPrizes();
            bootstrap.Modal.getInstance(document.getElementById('addPrizeModal')).hide();
            document.getElementById('prizeForm').reset();
            document.getElementById('prizeIndex').value = '';
        }

        // Chỉnh sửa giải
        function editPrize(index) {
            document.getElementById('prizeName').value = prizes[index].name;
            document.getElementById('prizeTurns').value = prizes[index].turns;
            document.getElementById('prizeIndex').value = index;
            document.getElementById('addPrizeModalLabel').textContent = 'Chỉnh sửa giải';
            new bootstrap.Modal(document.getElementById('addPrizeModal')).show();
        }

        // Xóa giải
        function deletePrize(index) {
            if (confirm('Bạn có chắc chắn muốn xóa giải này?')) {
                prizes.splice(index, 1);
                localStorage.setItem('prizes', JSON.stringify(prizes));
                displayPrizes();
            }
        }

        // Hiển thị danh sách người tham dự
        function displayParticipants() {
            const tableBody = document.getElementById('participantTableBody');
            tableBody.innerHTML = '';
            participants.forEach((participant, index) => {
                const row = `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${participant.name}</td>
                        <td>${participant.department}</td>
                        <td>${participant.code}</td>
                        <td>
                            <button class="btn btn-warning btn-sm" onclick="editParticipant(${index})">Sửa</button>
                            <button class="btn btn-danger btn-sm" onclick="deleteParticipant(${index})">Xóa</button>
                        </td>
                    </tr>
                `;
                tableBody.innerHTML += row;
            });
        }

        // Thêm hoặc chỉnh sửa người tham dự
        function saveParticipant() {
            const name = document.getElementById('participantName').value;
            const department = document.getElementById('participantDepartment').value;
            const code = document.getElementById('participantCode').value;
            const index = document.getElementById('participantIndex').value;

            if (index === '') {
                // Thêm mới
                participants.push({ name, department, code });
            } else {
                // Cập nhật
                participants[index] = { name, department, code };
            }

            localStorage.setItem('participants', JSON.stringify(participants));
            displayParticipants();
            bootstrap.Modal.getInstance(document.getElementById('addParticipantModal')).hide();
            document.getElementById('participantForm').reset();
            document.getElementById('participantIndex').value = '';
        }

        // Chỉnh sửa người tham dự
        function editParticipant(index) {
            document.getElementById('participantName').value = participants[index].name;
            document.getElementById('participantDepartment').value = participants[index].department;
            document.getElementById('participantCode').value = participants[index].code;
            document.getElementById('participantIndex').value = index;
            document.getElementById('addParticipantModalLabel').textContent = 'Chỉnh sửa người tham dự';
            new bootstrap.Modal(document.getElementById('addParticipantModal')).show();
        }

        // Xóa người tham dự
        function deleteParticipant(index) {
            if (confirm('Bạn có chắc chắn muốn xóa người tham dự này?')) {
                participants.splice(index, 1);
                localStorage.setItem('participants', JSON.stringify(participants));
                displayParticipants();
            }
        }

        // Hiển thị danh sách trúng giải
        function displayWinners() {
            const tableBody = document.getElementById('winnerTableBody');
            tableBody.innerHTML = '';
            winners.forEach((winner, index) => {
                const row = `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${winner.date}</td>
                        <td>${winner.prize}</td>
                        <td>${winner.turn}</td>
                        <td>${winner.name}</td>
                        <td>${winner.department}</td>
                        <td>${winner.code}</td>
                        <td>
                            <button class="btn btn-danger btn-sm" onclick="deleteWinner(${index})">Xóa</button>
                        </td>
                    </tr>
                `;
                tableBody.innerHTML += row;
            });
        }

        // Xóa người trúng giải
        function deleteWinner(index) {
            if (confirm('Bạn có chắc chắn muốn xóa người trúng giải này?')) {
                winners.splice(index, 1);
                localStorage.setItem('winners', JSON.stringify(winners));
                displayWinners();
            }
        }

        // Khởi tạo hiển thị khi tải trang
        displayPrizes();
        displayParticipants();
        displayWinners();
    </script>
</body>
</html>